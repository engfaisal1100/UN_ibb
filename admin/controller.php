<?php
// โ ูุฌุจ ุชุนุฑูู ูุฐุง ุฃูููุง
// ุชุญุฏูุฏ ูุณุงุฑ ููู ุงูุจูุงูุงุช JSON (ูุณุชุฎุฏู __DIR__ ููุญุตูู ุนูู ุงููุณุงุฑ ุจุดูู ุขูู)
define('DATA_FILE', __DIR__ . '/data.json');

// ุฏุงูุฉ ูุชุญููู ุงูุจูุงูุงุช ูู ููู JSON
function loadData() {
    // ูุฑุงุกุฉ ูุญุชููุงุช ููู JSON ูุชุญููููุง ุฅูู ูุตูููุฉ (Array)
    return json_decode(file_get_contents(DATA_FILE), true);
}

// ุฏุงูุฉ ูุญูุธ ุงูุจูุงูุงุช ุฅูู ููู JSON
function saveData($data) {
    // ุญูุธ ุงูุจูุงูุงุช ูู ุงูููู ุจุงุณุชุฎุฏุงู ุชูุณูู JSON
    file_put_contents(DATA_FILE, json_encode($data, JSON_PRETTY_PRINT | JSON_UNESCAPED_UNICODE));
}

////////////////////////////////////
// ๐ฐ ุงูุฃุฎุจุงุฑ
////////////////////////////////////

// ุฏุงูุฉ ูุฅุถุงูุฉ ุฎุจุฑ ุฌุฏูุฏ
function addNews($title, $date, $content) {
    try {
        // ุชุญููู ุงูุจูุงูุงุช ุงูุญุงููุฉ ูู ููู JSON
        $data = loadData();
        
        // ุชุญุฏูุฏ ID ุฌุฏูุฏ ููุฎุจุฑ ุจูุงุกู ุนูู ุขุฎุฑ ุฎุจุฑ ูู ุงููุงุฆูุฉ
        $lastId = count($data['news']) > 0 ? $data['news'][count($data['news']) - 1]['id'] : 0;
        $newId = $lastId + 1;
        
        // ุฅุนุฏุงุฏ ุงูุฎุจุฑ ุงูุฌุฏูุฏ
        $newNews = [
            'id' => $newId,
            'title' => $title,
            'date' => $date,
            'content' => $content
        ];

        // ุฅุถุงูุฉ ุงูุฎุจุฑ ุงูุฌุฏูุฏ ุฅูู ูุงุฆูุฉ ุงูุฃุฎุจุงุฑ
        $data['news'][] = $newNews;
        
        // ุญูุธ ุงูุจูุงูุงุช ุงููุนุฏูุฉ
        saveData($data);

        // ุฅุฑุฌุงุน ุงุณุชุฌุงุจุฉ ูุฌุงุญ
        echo json_encode([
            'status' => 'success',
            'message' => 'ุชูุช ุฅุถุงูุฉ ุงูุฎุจุฑ ุจูุฌุงุญ.'
        ]);
    } catch (Exception $e) {
        // ุฅุฑุฌุงุน ุงุณุชุฌุงุจุฉ ูุดู ูุน ุชูุงุตูู ุงูุฎุทุฃ
        echo json_encode([
            'status' => 'error',
            'message' => 'ูุดู ูู ุฅุถุงูุฉ ุงูุฎุจุฑ: ' . $e->getMessage()
        ]);
    }
}

// ุฏุงูุฉ ูุญุฐู ุฎุจุฑ
function deleteNews($id) {
    try {
        // ุชุญููู ุงูุจูุงูุงุช ุงูุญุงููุฉ ูู ููู JSON
        $data = loadData();
        
        // ุญูุธ ุนุฏุฏ ุงูุฃุฎุจุงุฑ ูุจู ุงูุญุฐู
        $originalCount = count($data['news']);
        
        // ุชุตููุฉ ุงูุฃุฎุจุงุฑ ูุฅุฒุงูุฉ ุงูุฎุจุฑ ุงูุฐู ูุญุชูู ุนูู ููุณ ID
        $data['news'] = array_values(array_filter($data['news'], fn($item) => $item['id'] != $id));
        
        // ุญูุธ ุงูุจูุงูุงุช ุงููุนุฏูุฉ
        saveData($data);
        
        // ุงูุชุญูู ูู ูุฌุงุญ ุนูููุฉ ุงูุญุฐู
        if ($originalCount !== count($data['news'])) {
            echo json_encode([
                'status' => 'success',
                'message' => 'ุชู ุญุฐู ุงูุฎุจุฑ ุจูุฌุงุญ.'
            ]);
        } else {
            echo json_encode([
                'status' => 'error',
                'message' => 'ูู ูุชู ุงูุนุซูุฑ ุนูู ุงูุฎุจุฑ ุงููุฑุงุฏ ุญุฐูู.'
            ]);
        }
    } catch (Exception $e) {
        // ุฅุฑุฌุงุน ุงุณุชุฌุงุจุฉ ูุดู ูุน ุชูุงุตูู ุงูุฎุทุฃ
        echo json_encode([
            'status' => 'error',
            'message' => 'ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุงูุญุฐู: ' . $e->getMessage()
        ]);
    }
}

////////////////////////////////////
// ุฏูุงู ุงูุชุญุฏูุซ ุงูุฃุฎุฑู
////////////////////////////////////

// ุฏุงูุฉ ูุชุญุฏูุซ ุจูุงูุงุช "ุนู ุงูุฌุงูุนุฉ"
function updateAbout($description, $vision, $mission) {
    try {
        // ุชุญููู ุงูุจูุงูุงุช ูู ููู JSON
        $data = loadData();
        
        // ุชุญุฏูุซ ุจูุงูุงุช "ุนู ุงูุฌุงูุนุฉ"
        $data['about']['description'] = $description;
        $data['about']['vision'] = $vision;
        $data['about']['mission'] = $mission;
        
        // ุญูุธ ุงูุจูุงูุงุช ุงููุนุฏูุฉ ูู ููู JSON
        saveData($data);

        // ุฅุฑุฌุงุน ุงุณุชุฌุงุจุฉ ุจุงููุฌุงุญ
        echo json_encode([
            'status' => 'success',
            'message' => 'ุชู ุญูุธ ุงูุชุนุฏููุงุช ุจูุฌุงุญ.'
        ]);
    } catch (Exception $e) {
        // ุฅุฑุฌุงุน ุงุณุชุฌุงุจุฉ ูู ุญุงูุฉ ุญุฏูุซ ุฎุทุฃ
        echo json_encode([
            'status' => 'error',
            'message' => 'ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญูุธ ุงูุชุนุฏููุงุช: ' . $e->getMessage()
        ]);
    }
}

// ุฏุงูุฉ ูุชุญุฏูุซ ุจูุงูุงุช "ูุนูููุงุช ุงูุชูุงุตู"
function updateContact($address, $phone, $email,$rights,$devloper, $facebook, $twitter, $instagram) {
    try {
        // ุชุญููู ุงูุจูุงูุงุช ูู ููู JSON
        $data = loadData();
        
        // ุชุญุฏูุซ ุจูุงูุงุช "ูุนูููุงุช ุงูุชูุงุตู"
        $data['contact']['address'] = $address;
        $data['contact']['phone'] = $phone;
        $data['contact']['email'] = $email;
        $data['contact']['rights'] = $rights;
        $data['contact']['devloper'] = $devloper;
        $data['contact']['social']['facebook'] = $facebook;
        $data['contact']['social']['twitter'] = $twitter;
        $data['contact']['social']['instagram'] = $instagram;
        
        // ุญูุธ ุงูุจูุงูุงุช ุงููุนุฏูุฉ ูู ููู JSON
        saveData($data);

        // ุฅุฑุฌุงุน ุงุณุชุฌุงุจุฉ ุจุงููุฌุงุญ
        echo json_encode([
            'status' => 'success',
            'message' => 'ุชู ุญูุธ ุงูุชุนุฏููุงุช ุจูุฌุงุญ.'
        ]);
    } catch (Exception $e) {
        // ุฅุฑุฌุงุน ุงุณุชุฌุงุจุฉ ูู ุญุงูุฉ ุญุฏูุซ ุฎุทุฃ
        echo json_encode([
            'status' => 'error',
            'message' => 'ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญูุธ ุงูุชุนุฏููุงุช: ' . $e->getMessage()
        ]);
    }
}
function updatePresidentMessage() {
    try {
        $data = json_decode(file_get_contents('data.json'), true);
        $name = $_POST['name'] ?? '';
        $title = $_POST['title'] ?? '';
        $message = $_POST['message'] ?? '';
        $imagePath = '';

        if (isset($_FILES['image']) && $_FILES['image']['error'] === UPLOAD_ERR_OK) {
            $uploadDir = 'images/';
            if (!is_dir($uploadDir)) mkdir($uploadDir, 0755, true);

            $fileTmp = $_FILES['image']['tmp_name'];
            $fileName = basename($_FILES['image']['name']);
            $fileExt = pathinfo($fileName, PATHINFO_EXTENSION);
            $newFileName = uniqid('president_', true) . '.' . $fileExt;
            $destination = $uploadDir . $newFileName;

            if (move_uploaded_file($fileTmp, $destination)) {
                $imagePath = $destination;
            } else {
                echo json_encode(['status' => 'error', 'message' => 'ูุดู ูู ุฑูุน ุงูุตูุฑุฉ.']);
                return;
            }
        } else {
            $imagePath = $data['presidentMessage']['image'];
        }

        $data['presidentMessage'] = [
            'name' => $name,
            'title' => $title,
            'message' => $message,
            'image' => $imagePath
        ];

        file_put_contents('data.json', json_encode($data, JSON_UNESCAPED_UNICODE | JSON_PRETTY_PRINT));

        echo json_encode(['status' => 'success', 'message' => 'ุชู ุญูุธ ุงูุชุนุฏููุงุช ุจูุฌุงุญ.']);
    } catch (Exception $e) {
        echo json_encode(['status' => 'error', 'message' => 'ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุงูุญูุธ: ' . $e->getMessage()]);
    }
}

function updateHeroItems() {
    try {
        $data = json_decode(file_get_contents('data.json'), true);
        $heroItems = $_POST['hero'] ?? [];

        // ูุณุงุฑ ูุฌูุฏ ุงูุตูุฑ
        $uploadDir = 'images/';
        if (!is_dir($uploadDir)) {
            mkdir($uploadDir, 0755, true);
        }

        // ูุนุงูุฌุฉ ูู ุนูุตุฑ ูู ุงููุงุฑูุณูู
        foreach ($heroItems as $index => &$item) {
            // ุงุณู ุงูููู ุงููุฑููุน
            $fileKey = "hero_image_$index";

            // ุฅุฐุง ุชู ุฑูุน ุตูุฑุฉ ุฌุฏูุฏุฉ
            if (isset($_FILES[$fileKey]) && $_FILES[$fileKey]['error'] === UPLOAD_ERR_OK) {
                $fileTmp = $_FILES[$fileKey]['tmp_name'];
                $fileName = basename($_FILES[$fileKey]['name']);
                $fileExt = pathinfo($fileName, PATHINFO_EXTENSION);
                $newFileName = uniqid("hero_$index", true) . '.' . $fileExt;
                $destination = $uploadDir . $newFileName;

                if (move_uploaded_file($fileTmp, $destination)) {
                    $item['image'] = $destination;
                } else {
                    echo json_encode([
                        'status' => 'error',
                        'message' => "ูุดู ูู ุฑูุน ุงูุตูุฑุฉ ุฑูู " . ($index + 1)
                    ]);
                    return;
                }
            } else {
                // ุงูุงุญุชูุงุธ ุจุงูุตูุฑุฉ ุงููุฏููุฉ
                $item['image'] = $data['hero'][$index]['image'];
            }
        }

        // ุชุญุฏูุซ ุงูุจูุงูุงุช
        $data['hero'] = $heroItems;
        file_put_contents('data.json', json_encode($data, JSON_UNESCAPED_UNICODE | JSON_PRETTY_PRINT));

        echo json_encode([
            'status' => 'success',
            'message' => 'ุชู ุญูุธ ุงูุชุนุฏููุงุช ุจูุฌุงุญ.'
        ]);

    } catch (Exception $e) {
        echo json_encode([
            'status' => 'error',
            'message' => 'ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญูุธ ุงูุชุนุฏููุงุช: ' . $e->getMessage()
        ]);
    }
}

////////////////////////////////////
// ๐ ุงูุฃูุณุงู
////////////////////////////////////
// ุฏุงูุฉ ูุฅุถุงูุฉ ูุณู ุฌุฏูุฏ ููุท
function addDepartment($name, $description) {
    // ุชุญููู ุงูุจูุงูุงุช ุงูุญุงููุฉ
    $data = loadData();  // ุฏุงูุฉ ูุชุญููู ุงูุจูุงูุงุช ูู ุงูููู

    // ุชูููุฏ ID ูุฑูุฏ ูููุณู ุงูุฌุฏูุฏ
    $newId = count($data['departments']) > 0 ? max(array_column($data['departments'], 'id')) + 1 : 1;

    // ุฅุนุฏุงุฏ ุจูุงูุงุช ุงููุณู ุงูุฌุฏูุฏ
    $newDepartment = [
        'id' => $newId,
        'name' => $name,
        'description' => $description,
        'courses' => [] // ูุง ููุฌุฏ ููุฑุฑุงุช ูุจุฏุฆููุง
    ];

    // ุฅุถุงูุฉ ุงููุณู ุงูุฌุฏูุฏ ุฅูู ุงูุจูุงูุงุช
    $data['departments'][] = $newDepartment;

    // ุญูุธ ุงูุจูุงูุงุช ุงููุญุฏุซุฉ
    saveData($data);  // ุฏุงูุฉ ูุญูุธ ุงูุจูุงูุงุช ูู ุงูููู

    // ุฅุฑุฌุงุน ุงุณุชุฌุงุจุฉ ุจุงููุฌุงุญ
    echo json_encode([
        'status' => 'success',
        'message' => 'ุชู ุฅุถุงูุฉ ุงููุณู ุจูุฌุงุญ.'
    ]);
}

// ุฏุงูุฉ ูุฅุถุงูุฉ ููุฑุฑ ุฅูู ูุณู ูุนูู
function addCourseToDepartment($departmentId, $title, $code, $credits,$trem, $instructor, $description) {
    // ุชุญููู ุงูุจูุงูุงุช ุงูุญุงููุฉ
    $data = loadData();  // ุฏุงูุฉ ูุชุญููู ุงูุจูุงูุงุช ูู ุงูููู

    // ุงูุจุญุซ ุนู ุงููุณู ุจูุงุกู ุนูู ID
    foreach ($data['departments'] as &$department) {
        if ($department['id'] == $departmentId) {
            // ุฅุนุฏุงุฏ ุจูุงูุงุช ุงูููุฑุฑ ุงูุฌุฏูุฏ
            $newCourse = [
                'title' => $title,
                'code' => $code,
                'credits' => $credits,
                 'trem' => $trem,
                'instructor' => $instructor,
                'description' => $description
            ];

            // ุฅุถุงูุฉ ุงูููุฑุฑ ุฅูู ุงููุณู
            $department['courses'][] = $newCourse;

            // ุญูุธ ุงูุจูุงูุงุช ุงููุญุฏุซุฉ
            saveData($data);  // ุฏุงูุฉ ูุญูุธ ุงูุจูุงูุงุช ูู ุงูููู

            // ุฅุฑุฌุงุน ุงุณุชุฌุงุจุฉ ุจุงููุฌุงุญ
            echo json_encode([
                'status' => 'success',
                'message' => 'ุชู ุฅุถุงูุฉ ุงูููุฑุฑ ุจูุฌุงุญ.'
            ]);
            return;
        }
    }

    // ูู ุญุงู ูู ูุชู ุงูุนุซูุฑ ุนูู ุงููุณู
    echo json_encode([
        'status' => 'error',
        'message' => 'ุงููุณู ุบูุฑ ููุฌูุฏ.'
    ]);
}


// ุฏุงูุฉ ูุญุฐู ูุณู
function deleteDepartment($id) {
    $data = loadData();

    // ุงูุจุญุซ ุนู ุงููุณู ุจุงุณุชุฎุฏุงู id
    $departmentIndex = null;
    foreach ($data['departments'] as $index => $department) {
        if ($department['id'] == $id) {
            $departmentIndex = $index;
            break;
        }
    }

    if ($departmentIndex !== null) {
        unset($data['departments'][$departmentIndex]);
        $data['departments'] = array_values($data['departments']); // ุฅุนุงุฏุฉ ุชุฑุชูุจ ุงูููุฑุณ ุจุนุฏ ุงูุญุฐู
        saveData($data);

        echo json_encode([
            'status' => 'success',
            'message' => 'ุชู ุญุฐู ุงููุณู ุจูุฌุงุญ.'
        ]);
    } else {
        echo json_encode([
            'status' => 'error',
            'message' => 'ูู ูุชู ุงูุนุซูุฑ ุนูู ุงููุณู.'
        ]);
    }
}

////////////////////////////////////
// ๐จโ๐ซ ุงูุทุงูู ุงูุฃูุงุฏููู
////////////////////////////////////
function addStaff($name, $title, $department,$bio) {
    try {
        // ุชุญููู ุงูุจูุงูุงุช ูู JSON
        $data = loadData();

        // ูุณุงุฑ ุฑูุน ุงูุตูุฑ
        $uploadDir = 'images/';

        // ุงูุชุญูู ูู ุฑูุน ุงูุตูุฑุฉ
        if (!isset($_FILES['image']) || $_FILES['image']['error'] !== UPLOAD_ERR_OK) {
            throw new Exception('ูู ูุชู ุฑูุน ุงูุตูุฑุฉ ุฃู ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุงูุฑูุน.');
        }

        // ุฅูุดุงุก ุงููุฌูุฏ ุฅุฐุง ูู ููู ููุฌูุฏูุง
        if (!is_dir($uploadDir)) {
            mkdir($uploadDir, 0777, true);
        }

        // ุฅูุดุงุก ุงุณู ูุฑูุฏ ููุตูุฑุฉ
        $fileExt = pathinfo($_FILES['image']['name'], PATHINFO_EXTENSION);
        $fileName = uniqid('staff_') . '.' . $fileExt;
        $filePath = $uploadDir . $fileName;

        // ููู ุงูุตูุฑุฉ
        if (!move_uploaded_file($_FILES['image']['tmp_name'], $filePath)) {
            throw new Exception('ูุดู ูู ุญูุธ ุงูุตูุฑุฉ ุนูู ุงูุฎุงุฏู.');
        }

        // ุชูููุฏ ID ุฌุฏูุฏ
        $newId = count($data['staff']) > 0 ? max(array_column($data['staff'], 'id')) + 1 : 1;

        // ุฅุนุฏุงุฏ ุจูุงูุงุช ุงูุนุถู ุงูุฌุฏูุฏ
        $newStaff = [
            'id' => $newId,
            'name' => $name,
            'title' => $title,
            'department' => $department,
            'image' => $filePath,
            'bio' => $bio
        ];

        // ุฅุถุงูุฉ ุงูุนุถู
        $data['staff'][] = $newStaff;

        // ุญูุธ ุงูุชุญุฏูุซ
        saveData($data);

        // ุฅุฑุฌุงุน ุงุณุชุฌุงุจุฉ
        echo json_encode([
            'status' => 'success',
            'message' => 'ุชู ุฅุถุงูุฉ ุงูุนุถู ุจูุฌุงุญ.'
        ]);
    } catch (Exception $e) {
        echo json_encode([
            'status' => 'error',
            'message' => 'ูุดู ูู ุฅุถุงูุฉ ุงูุนุถู: ' . $e->getMessage()
        ]);
    }
}

// ุฏุงูุฉ ูุญุฐู ุนุถู ุฃูุงุฏููู
function deleteStaff($id) {
    $data = loadData();
    
    // ุงูุจุญุซ ุนู ุงูุนุถู ุจุงุณุชุฎุฏุงู id
    $staffIndex = null;
    foreach ($data['staff'] as $index => $member) {
        if ($member['id'] == $id) {
            $staffIndex = $index;
            break;
        }
    }

    if ($staffIndex !== null) {
        unset($data['staff'][$staffIndex]);
        $data['staff'] = array_values($data['staff']);
        saveData($data);

        echo json_encode([
            'status' => 'success',
            'message' => 'ุชู ุญุฐู ุงูุนุถู ุจูุฌุงุญ.'
        ]);
    } else {
        echo json_encode([
            'status' => 'error',
            'message' => 'ูู ูุชู ุงูุนุซูุฑ ุนูู ุงูุนุถู.'
        ]);
    }
}

function updateSettings($postData, $fileData) {
    try {
        // ุชุญููู ุงูุจูุงูุงุช ูู ููู JSON
        $data = json_decode(file_get_contents('data.json'), true);

        // ูุณุงุฑุงุช ุงูุตูุฑ ุงูุงูุชุฑุงุถูุฉ (ุงููุณุชุฎุฏูุฉ ุฅุฐุง ูู ุชูุฑูุน ุตูุฑ ุฌุฏูุฏุฉ)
        $logoPath = $data['setting']['logo_url'];
        $faviconPath = $data['setting']['favicon_url'];

        // ุงูุชุญูู ูู ุฑูุน ุดุนุงุฑ ุฌุฏูุฏ
        if (isset($fileData['logo_file']) && $fileData['logo_file']['error'] === UPLOAD_ERR_OK) {
            $tmpName = $fileData['logo_file']['tmp_name'];
            $extension = pathinfo($fileData['logo_file']['name'], PATHINFO_EXTENSION);
            $logoName = 'logo_' . time() . '.' . $extension;
            $uploadPath = 'images/' . $logoName;
            if (move_uploaded_file($tmpName, $uploadPath)) {
                $logoPath = $uploadPath;
            }
        }

        // ุงูุชุญูู ูู ุฑูุน ูุงููููู ุฌุฏูุฏ
        if (isset($fileData['favicon_file']) && $fileData['favicon_file']['error'] === UPLOAD_ERR_OK) {
            $tmpName = $fileData['favicon_file']['tmp_name'];
            $extension = pathinfo($fileData['favicon_file']['name'], PATHINFO_EXTENSION);
            $faviconName = 'favicon_' . time() . '.' . $extension;
            $uploadPath = 'images/' . $faviconName;
            if (move_uploaded_file($tmpName, $uploadPath)) {
                $faviconPath = $uploadPath;
            }
        }

        // ุชุญุฏูุซ ุจูุงูุงุช ุงูุฅุนุฏุงุฏุงุช
        $data['setting'] = [
            'site_name'      => $postData['site_name'],
            'title'          => $postData['title'],
            'description'    => $postData['description'],
            'keywords'       => $postData['keywords'],
            'author'         => $postData['author'],
            'language'       => $postData['language'],
            'timezone'       => $postData['timezone'],
            'logo_url'       => $logoPath,
            'favicon_url'    => $faviconPath,
            'contact_email'  => $postData['contact_email'],
            'contact_phone'  => $postData['contact_phone'],
            'social'         => [
                'facebook'  => $postData['facebook'],
                'twitter'   => $postData['twitter'],
                'instagram' => $postData['instagram'],
            ],
            'comment'        => $postData['comment']
        ];

        // ุญูุธ ุงูุจูุงูุงุช ูู ููู JSON
        file_put_contents('data.json', json_encode($data, JSON_PRETTY_PRINT | JSON_UNESCAPED_UNICODE));

        echo json_encode([
            'status' => 'success',
            'message' => 'โ ุชู ุญูุธ ุงูุชุนุฏููุงุช ุจูุฌุงุญ.'
        ]);
    } catch (Exception $e) {
        echo json_encode([
            'status' => 'error',
            'message' => 'โ ุฎุทุฃ ุฃุซูุงุก ุญูุธ ุงูุชุนุฏููุงุช: ' . $e->getMessage()
        ]);
    }
}


////////////////////////////////////
// ๐ ุงุณุชุฏุนุงุก ุงูุฏูุงู ุนูุฏ ุฅุฌุฑุงุก ูู ุญุฏุซ
////////////////////////////////////
if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    // ุญุงูุฉ ุฅุถุงูุฉ ุงูุฎุจุฑ
    if (isset($_POST['action']) && $_POST['action'] === 'addnews') {
        // ุงุณุชุฏุนุงุก ุฏุงูุฉ ุฅุถุงูุฉ ุงูุฎุจุฑ ูุน ุชูุฑูุฑ ุงูุนููุงูุ ุงูุชุงุฑูุฎุ ูุงููุญุชูู
        addNews($_POST['title'], $_POST['date'], $_POST['content']);
    
    // ุญุงูุฉ ุญุฐู ุงูุฎุจุฑ
    } elseif (isset($_POST['action']) && $_POST['action'] === 'deletenews') {
        // ุฃุฎุฐ ูููุฉ ID ุงูุฎุจุฑ ูู ุงูุทูุจ
        $id = isset($_POST['id']) ? intval($_POST['id']) : 0;
        // ุงุณุชุฏุนุงุก ุฏุงูุฉ ุญุฐู ุงูุฎุจุฑ ูุน ุชูุฑูุฑ ID ุงูุฎุจุฑ
        deleteNews($id);
    
    // ุญุงูุฉ ุฅุถุงูุฉ ุนุถู ุฃูุงุฏููู ุฌุฏูุฏ
    } elseif (isset($_POST['action']) && $_POST['action'] === 'addstaff') {
        // ุงุณุชุฏุนุงุก ุฏุงูุฉ ุฅุถุงูุฉ ุนุถู ุฃูุงุฏููู ูุน ุชูุฑูุฑ ุงูุงุณูุ ุงูุนููุงูุ ุงููุณูุ ูุตูุฑุฉ ุงูุนุถู
        addStaff($_POST['name'], $_POST['title'], $_POST['department'],$_POST['bio']);
    
    // ุญุงูุฉ ุญุฐู ุนุถู ุฃูุงุฏููู
    } elseif (isset($_POST['action']) && $_POST['action'] === 'deletestaff') {
        // ุฃุฎุฐ ูููุฉ ID ุงูุนุถู ุงูุฃูุงุฏููู ูู ุงูุทูุจ
        $id = isset($_POST['id']) ? intval($_POST['id']) : 0;
        // ุงุณุชุฏุนุงุก ุฏุงูุฉ ุญุฐู ุนุถู ุฃูุงุฏููู ูุน ุชูุฑูุฑ ID ุงูุนุถู
        deleteStaff($id);

}elseif (isset($_POST['action']) && $_POST['action'] === 'adddepartment') {
    // ุงุณุชุฏุนุงุก ุฏุงูุฉ ุฅุถุงูุฉ ุงููุณู ูุน ุชูุฑูุฑ ุงูููุฑุฑุงุช ุฃูุถูุง
    $courses = isset($_POST['courses']);
    addDepartment($_POST['name'], $_POST['description']);
}elseif (isset($_POST['action']) && $_POST['action'] === 'addcourse') {
    // ุงูุชุญูู ูู ูุฌูุฏ ูุงูุฉ ุงูุจูุงูุงุช ุงููุทููุจุฉ
    if (isset($_POST['department_id'], $_POST['title'], $_POST['code'], $_POST['credits'],$_POST['term'], $_POST['instructor'], $_POST['description'])
    ) {
        // ุงุณุชุฏุนุงุก ุงูุฏุงูุฉ ูุชูุฑูุฑ ุงูุจูุงูุงุช
        addCourseToDepartment(
            (int) $_POST['department_id'],    // ุฑูู ุงููุณู
            $_POST['title'],                  // ุงุณู ุงูููุฑุฑ
            $_POST['code'],                   // ุฑูุฒ ุงูููุฑุฑ
            (int) $_POST['credits'], 
             (int) $_POST['term'],          // ุนุฏุฏ ุงูุณุงุนุงุช
            $_POST['instructor'],             // ุงุณู ุงููุฏุฑุณ
            $_POST['description']             // ูุตู ุงูููุฑุฑ
        );
    } else {
        // ูู ุญุงู ููุต ุงูุจูุงูุงุช
        echo json_encode([
            'status' => 'error',
            'message' => 'ูุฑุฌู ุชุนุจุฆุฉ ุฌููุน ุงูุญููู ุงููุทููุจุฉ ูุฅุถุงูุฉ ุงูููุฑุฑ.'
        ]);
    }
}elseif (isset($_POST['action']) && $_POST['action'] === 'deletedepartment') {
        // ุฃุฎุฐ ูููุฉ ID ุงููุณู ูู ุงูุทูุจ
        $id = isset($_POST['id']) ? intval($_POST['id']) : 0;
        // ุงุณุชุฏุนุงุก ุฏุงูุฉ ุญุฐู ูุณู ูุน ุชูุฑูุฑ ID ุงููุณู
        deleteDepartment($id);
    
    // ุญุงูุฉ ุชุญุฏูุซ ุจูุงูุงุช "ุนู ุงูุฌุงูุนุฉ"
    } else if (isset($_POST['action']) && $_POST['action'] === 'updateabout') {
        // ุงุณุชุฏุนุงุก ุฏุงูุฉ ุชุญุฏูุซ ุจูุงูุงุช "ุนู ุงูุฌุงูุนุฉ" ูุน ุชูุฑูุฑ ุงูุจูุงูุงุช ุงููุนุฏูุฉ
        updateAbout($_POST['description'], $_POST['vision'], $_POST['mission']);
    
    // ุญุงูุฉ ุชุญุฏูุซ ุจูุงูุงุช "ูุนูููุงุช ุงูุชูุงุตู"
    } elseif (isset($_POST['action']) && $_POST['action'] === 'updatecontact') {
        // ุงุณุชุฏุนุงุก ุฏุงูุฉ ุชุญุฏูุซ ุจูุงูุงุช "ูุนูููุงุช ุงูุชูุงุตู" ูุน ุชูุฑูุฑ ุงูุจูุงูุงุช ุงููุนุฏูุฉ
        updateContact($_POST['address'], $_POST['phone'], $_POST['email'],$_POST['rights'],$_POST['devloper'],$_POST['facebook'], $_POST['twitter'], $_POST['instagram']);
    
    // ุญุงูุฉ ุชุญุฏูุซ "ูููุฉ ุฑุฆูุณ ุงูุฌุงูุนุฉ"
    } elseif (isset($_POST['action']) && $_POST['action'] === 'updatepresident') {
        // ุงุณุชุฏุนุงุก ุฏุงูุฉ ุชุญุฏูุซ "ูููุฉ ุฑุฆูุณ ุงูุฌุงูุนุฉ" ูุน ุชูุฑูุฑ ุงูุจูุงูุงุช ุงููุนุฏูุฉ
        updatePresidentMessage();
    
    // ุญุงูุฉ ุชุญุฏูุซ ุฎูููุงุช ุงููุงุฑูุณูู
    } elseif (isset($_POST['action']) && $_POST['action'] === 'updatehero') {
        // ุงุณุชุฏุนุงุก ุฏุงูุฉ ุชุญุฏูุซ ุฎูููุงุช ุงููุงุฑูุณูู ูุน ุชูุฑูุฑ ุงูุจูุงูุงุช ุงููุนุฏูุฉ
        updateHeroItems();
    
    // ุญุงูุฉ ุชุญุฏูุซ ุฅุนุฏุงุฏุงุช ุงููููุน
    } elseif (isset($_POST['action']) && $_POST['action'] === 'updateSettings') {
        // ุงุณุชุฏุนุงุก ุฏุงูุฉ ุชุญุฏูุซ ุฅุนุฏุงุฏุงุช ุงููููุน ูุน ุชูุฑูุฑ ุงูุจูุงูุงุช ุงููุนุฏูุฉ
        updateSettings($_POST, $_FILES);
    }
}

?>
